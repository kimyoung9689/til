### 변분 오토 인코더(Variational Autoencoder, VAE)

일반 오토 인코더는 입력 데이터를 저차원 벡터로 압축했다가 다시 복원하는 모델

VAE는 입력 데이터를 평균과 분산이라는 두 개의 벡터로 압축하는 방식을 사용

이렇게 압축된 평균과 분산은 정규 분포 형태의 잠재 공간을 생성 

VAE는 이 잠재 공간에서 임의의 벡터를 샘플링해서 새로운 데이터를 만들어낸다. 

이 때문에 VAE는 이미지를 생성하는 모델로도 많이 활용, 특히 얼굴 표정이나 헤어스타일, 안경 착용 여부 등 데이터의 속성을 조절하면서 이미지를 생성할 수 있음

### VAE의 학습 방법

VAE는 두 가지 손실 함수를 사용해서 학습

1. **재구성 손실(Reconstruction Loss):**

       원본 데이터와 VAE가 다시 만들어낸 데이터 사이의 차이를 줄이는 역할

1. **KL 다이버전스(KL Divergence)**

       VAE가 만든 잠재 공간의 분포가 표준 정규 분포와 비슷해지도록 만들어주는 역할

이 두 가지 손실 함수를 모두 최소화하는 방향으로 학습을 진행하면, 

VAE는 학습한 데이터와 비슷한 특징을 가진 새로운 데이터를 생성할 수 있게 된다.

### VAE의 특징과 활용

**잠재 공간의 연속성과 매니폴드(Manifold):** VAE는 잠재 공간을 부드럽고 연속적인 형태로 만듦

따라서 잠재 공간의 한 지점에서 다른 지점으로 이동하며 새로운 데이터를 만들 때, 

결과물이 갑자기 확 바뀌는 게 아니라 자연스럽게 변하는 것을 볼 수 있다. 

이 때문에 VAE는 데이터가 가진 매니폴드를 효과적으로 학습한다고 말함

**이상치 탐지:** 일반적인 데이터는 잠재 공간의 중심 부분에 모여 분포하지만, 

이상치 데이터는 잠재 공간의 외곽에 위치하거나 복원 오류가 크게 나타남 

이를 이용해서 이상치를 찾아낼 수 있다.

**데이터 증강:** VAE의 잠재 공간에서 새로운 데이터를 생성해서 학습 데이터의 양을 늘리는 **데이터 증강**에도 활용될 수 있다.

결론, 변분 오토 인코더는 일반 오토 인코더의 장점인 압축과 복원뿐만 아니라, 

잠재 공간을 활용한 **새로운 데이터 생성**에 특화된 모델이라고 할 수 있다.

### 오토 인코더와 변분 오토 인코더 장단점 비교

| 구분 | 일반 오토 인코더 (Autoencoder) | 변분 오토 인코더 (Variational Autoencoder, VAE) |
| --- | --- | --- |
| **압축 결과** | 데이터의 특징을 하나의 벡터(점)로 압축한다. | 데이터의 특징을 **확률 분포** (평균, 분산)로 압축한다. |
| **잠재 공간** | 불연속적이고 예측하기 어렵다. | 연속적이고 부드러워, 샘플링이 가능하다. |
| **주요 활용** | **이상치 탐지, 특징 추출** | **새로운 데이터 생성, 데이터 증강** |
| **장점** | - **구조가 간단하고 학습이 쉽다.                         이상치 탐지에 효과적이다.** | - **새로운 데이터를 자유롭게 생성할 수 있다.**           **데이터의 속성을 조절하며 생성할 수 있다.** |
| **단점** | - **새로운 데이터 생성이 어렵다.                        데이터 속성 조절이 불가능하다.** | -**학습이 더 복잡하고 어렵다.**                                     **재구성 오류가 더 클 수 있다.** |

.

